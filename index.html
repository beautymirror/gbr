<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Beauty Ranking | Discover Your AI Beauty Score</title>
    <meta name="description" content="Find your place in the world beauty ranking. Our AI analyzes your photo to provide an objective score. Get your score now!">
    <meta name="keywords" content="beauty ranking, beauty score, world beauty ranking, ai beauty analysis, objective score, facial analysis">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F9FAFB;
            position: relative;
        }
        /* Animated gradient background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 200%;
            height: 200%;
            z-index: -1;
            background: radial-gradient(circle at 20% 20%, #e9d5ff, transparent 30%),
                        radial-gradient(circle at 80% 70%, #d1fae5, transparent 35%),
                        radial-gradient(circle at 50% 90%, #fbcfe8, transparent 40%);
            animation: gradient-flow 25s ease-in-out infinite;
        }
        @keyframes gradient-flow {
            0% { transform: translate(0, 0); }
            50% { transform: translate(-25%, -25%); }
            100% { transform: translate(0, 0); }
        }
        .logo-gradient-text {
            background: linear-gradient(90deg, #D946EF, #8B5CF6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .cta-button {
            background: linear-gradient(90deg, #D946EF, #8B5CF6);
            color: white;
            transition: all 0.3s ease-in-out;
        }
        .cta-button:hover {
            box-shadow: 0 10px 25px -5px rgba(139, 92, 246, 0.5), 0 0 15px rgba(217, 70, 239, 0.3);
            transform: translateY(-3px) scale(1.05);
        }
        .clean-card {
            background-color: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 1.25rem; /* 20px */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
            border: 1px solid #E5E7EB;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .tab-button.active {
            color: #8B5CF6;
            box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            background-color: white;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* Marquee styles */
        .marquee {
            overflow: hidden;
            position: relative;
            width: 100%;
            -webkit-mask-image: linear-gradient(to right, transparent, white 20%, white 80%, transparent);
            mask-image: linear-gradient(to right, transparent, white 20%, white 80%, transparent);
        }
        .marquee-content {
            display: flex;
            width: max-content;
            animation: marquee 30s linear infinite;
        }
        .marquee-content.reverse {
            animation-direction: reverse;
        }
        @keyframes marquee {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        /* Scroll animation */
        .reveal {
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }
        /* Styles for connecting line in "How It Works" */
        .how-it-works-container {
            position: relative;
        }
        .connecting-line {
            position: absolute;
            left: 2.5rem; /* Positioned to align with icons */
            top: 5rem;
            bottom: 5rem;
            width: 2px;
            background-color: #e5e7eb;
            z-index: 0;
        }
        .connecting-line-progress {
            height: 0;
            width: 100%;
            background: linear-gradient(180deg, #D946EF, #8B5CF6);
            transition: height 0.5s ease-out;
        }
    </style>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [{
        "@type": "Question",
        "name": "How accurate is the AI beauty ranking analysis?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Our AI is trained on a massive dataset of diverse images to analyze objective facial metrics like symmetry and proportions. While it provides a consistent, data-driven score, remember that beauty is deeply personal and subjective. Consider our ranking a fun, technological perspective, not a final judgment."
        }
      },{
        "@type": "Question",
        "name": "Are my photos and data secure?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Absolutely. Your privacy is our top priority. Your photo is used for the one-time analysis and is deleted immediately from our servers. We never store or share your images. The only data we keep for statistical rankings (like your first name and country) is anonymized."
        }
      }]
    }
    </script>
</head>
<body class="text-gray-900">

    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 border-b border-gray-200">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="index.html">
                <img src="logo.svg" alt="Global Beauty Rank Logo" class="h-16">
            </a>
            <nav class="hidden md:flex items-center space-x-8">
                <a href="#how-it-works" class="text-gray-600 hover:text-purple-600 transition font-medium">How It Works</a>
                <a href="#ratings" class="text-gray-600 hover:text-purple-600 transition font-medium">Rankings</a>
                <a href="#faq" class="text-gray-600 hover:text-purple-600 transition font-medium">FAQ</a>
            </nav>
            <a href="quiz.html" class="cta-button font-semibold px-6 py-2.5 rounded-lg">
                Get Your Score
            </a>
        </div>
    </header>

    <main>
        <section class="relative py-24 md:py-32 overflow-hidden">
            <div class="container mx-auto px-6 text-center relative z-10">
                <h1 class="text-5xl md:text-7xl font-black text-gray-900 leading-tight tracking-tighter">
                    How Does Artificial Intelligence <span class="logo-gradient-text">See Your Beauty?</span>
                </h1>
                <p class="mt-6 text-lg md:text-xl text-gray-600 max-w-3xl mx-auto">
                    One snapshot for an objective assessment of your attractiveness. Our technology analyzes dozens of facial parameters for an accurate and unbiased result.
                </p>
                <div class="mt-10 flex flex-col items-center justify-center gap-6">
                    <div class="group clean-card max-w-md w-full mx-auto p-6 shadow-lg cursor-pointer relative overflow-hidden">
                        <div class="relative flex items-center justify-center h-48">
                            <img src="https://images.unsplash.com/photo-1580489944761-15a19d654956?q=80&w=500&auto=format&fit=crop" alt="Sample face for analysis" class="absolute inset-0 w-full h-full object-cover rounded-lg transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 bg-black bg-opacity-20 group-hover:bg-opacity-50 transition-all duration-500 rounded-lg"></div>
                            <lottie-player src="analysis.json" background="transparent" speed="1" style="width: 250px; height: 250px;" loop autoplay class="absolute opacity-0 group-hover:opacity-80 transition-opacity duration-500"></lottie-player>
                            <div class="relative text-white text-center">
                                <p class="text-2xl font-bold opacity-100 group-hover:opacity-0 transition-opacity">Hover to see the AI magic</p>
                                <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-500">
                                    <p class="text-5xl font-black logo-gradient-text" style="-webkit-text-fill-color: white;">8.72/10</p>
                                </div>
                            </div>
                        </div>
                        <p class="text-lg text-gray-600 mt-4 font-semibold">Over <span id="participant-counter" class="font-bold text-purple-600">5.4 million</span> people have already discovered their score</p>
                    </div>
                    <a href="quiz.html" class="cta-button font-bold text-lg px-12 py-4 rounded-xl shadow-lg shadow-purple-500/10 inline-flex items-center">
                        Find Out Your Ranking
                    </a>
                    <div class="mt-4 text-gray-500 text-sm">
                        <p>⭐️⭐️⭐️⭐️⭐️ 4.9/5 based on 10,000+ reviews</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="py-20 space-y-4">
            <div class="text-center mb-8 reveal">
                <h2 class="text-3xl font-bold tracking-tighter">Recent Beauty Rank Analyses</h2>
                <p class="text-gray-500 mt-1">See who just got their beauty score.</p>
            </div>
            <div class="marquee">
                <div class="marquee-content" id="marquee-1"></div>
            </div>
            <div class="marquee">
                <div class="marquee-content reverse" id="marquee-2"></div>
            </div>
        </section>

        <section id="how-it-works" class="py-24 bg-white/50 backdrop-blur-md">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16 reveal">
                    <h2 class="text-4xl md:text-5xl font-extrabold tracking-tighter">How Our Ranking Works</h2>
                    <p class="mt-3 text-gray-600 max-w-2xl mx-auto">Get an objective beauty score in three easy steps.</p>
                </div>
                <div class="max-w-3xl mx-auto how-it-works-container">
                    <div class="connecting-line hidden md:block">
                        <div id="connecting-line-progress" class="connecting-line-progress"></div>
                    </div>
                    <div class="space-y-8 md:space-y-4">
                        <div class="sticky top-24 z-10 reveal" data-step="1">
                            <div class="clean-card p-8 md:p-10 flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-6">
                                <div class="flex-shrink-0">
                                    <lottie-player src="upload.json" background="transparent" speed="1" style="width: 120px; height: 120px;" loop autoplay></lottie-player>
                                </div>
                                <div>
                                    <p class="text-sm font-bold text-purple-600 uppercase">Step 1</p>
                                    <h3 class="text-2xl font-bold mt-1">Upload Your Photo</h3>
                                    <p class="mt-2 text-gray-600">Select a clear, well-lit selfie for the most accurate analysis.</p>
                                </div>
                            </div>
                        </div>
                        <div class="sticky top-32 z-20 reveal" data-step="2">
                           <div class="clean-card p-8 md:p-10 flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-6">
                                <div class="flex-shrink-0">
                                    <lottie-player src="analysis.json" background="transparent" speed="1" style="width: 120px; height: 120px;" loop autoplay></lottie-player>
                                </div>
                                <div>
                                    <p class="text-sm font-bold text-purple-600 uppercase">Step 2</p>
                                    <h3 class="text-2xl font-bold mt-1">AI-Powered Analysis</h3>
                                    <p class="mt-2 text-gray-600">Our neural network analyzes your photo across 128 facial parameters.</p>
                                </div>
                            </div>
                        </div>
                        <div class="sticky top-40 z-30 reveal" data-step="3">
                            <div class="clean-card p-8 md:p-10 flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-6">
                                <div class="flex-shrink-0">
                                    <lottie-player src="result.json" background="transparent" speed="1" style="width: 120px; height: 120px;" loop autoplay></lottie-player>
                                </div>
                                <div>
                                    <p class="text-sm font-bold text-purple-600 uppercase">Step 3</p>
                                    <h3 class="text-2xl font-bold mt-1">Get Your Results</h3>
                                    <p class="mt-2 text-gray-600">Receive your personal score and discover your position in the world ranking.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="ratings" class="py-20">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12 reveal">
                    <h2 class="text-4xl md:text-5xl font-extrabold tracking-tighter">World Ranking & Statistics</h2>
                    <p class="mt-3 text-gray-600 max-w-2xl mx-auto">Explore the data and see where you stand.</p>
                </div>
                <div class="clean-card max-w-4xl mx-auto p-6 md:p-8 flex flex-col">
                    <div class="p-1.5 bg-gray-100 rounded-xl flex items-center mb-6" id="main-tabs-nav">
                        <button data-tab-target="#countries" class="tab-button w-full text-center font-semibold py-2.5 rounded-lg transition active">Countries</button>
                        <button data-tab-target="#men" class="tab-button w-full text-center font-semibold py-2.5 rounded-lg transition">Men</button>
                        <button data-tab-target="#women" class="tab-button w-full text-center font-semibold py-2.5 rounded-lg transition">Women</button>
                        <button data-tab-target="#all" class="tab-button w-full text-center font-semibold py-2.5 rounded-lg transition">All</button>
                    </div>
                    <div id="main-tabs-content" class="relative">
                        <!-- Data will be populated by JS -->
                    </div>
                </div>
            </div>
        </section>

        <section id="faq" class="py-20 bg-white/50 backdrop-blur-md">
            <div class="container mx-auto px-6 max-w-3xl reveal">
                <div class="text-center mb-12">
                    <h2 class="text-4xl md:text-5xl font-extrabold tracking-tighter">Frequently Asked Questions</h2>
                </div>
                <div class="space-y-4">
                    <div class="clean-card"><details class="p-6 cursor-pointer group"><summary class="font-semibold text-lg flex justify-between items-center"><span class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 text-purple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>How accurate is the analysis?</span><span class="text-purple-500 transition group-open:rotate-45">+</span></summary><p class="mt-4 text-gray-600">Our AI is trained on a massive dataset of diverse images to analyze objective facial metrics like symmetry and proportions. Remember that beauty is subjective. Consider our ranking a fun, technological perspective, not a final judgment.</p></details></div>
                    <div class="clean-card"><details class="p-6 cursor-pointer group"><summary class="font-semibold text-lg flex justify-between items-center"><span class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 text-purple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" /></svg>Is my data secure?</span><span class="text-purple-500 transition group-open:rotate-45">+</span></summary><p class="mt-4 text-gray-600">Absolutely. <strong>Your privacy is our top priority.</strong> Your photo is used for the one-time analysis and is <strong>immediately deleted</strong> from our servers. We never store or share your images.</p></details></div>
                    <div class="clean-card"><details class="p-6 cursor-pointer group"><summary class="font-semibold text-lg flex justify-between items-center"><span class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 text-purple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>What does the AI analyze?</span><span class="text-purple-500 transition group-open:rotate-45">+</span></summary><p class="mt-4 text-gray-600">The AI evaluates dozens of objective parameters: facial symmetry, the 'golden ratio,' skin clarity (texture, not color), and proportions between facial features. It's a purely geometric and textural analysis.</p></details></div>
                </div>
            </div>
        </section>
    </main>

    <footer class="border-t border-gray-200 bg-white">
        <div class="container mx-auto px-6 py-8 text-center text-gray-600">
            <a href="index.html">
                <img src="logo.svg" alt="Global Beauty Rank Logo" class="h-16 mx-auto mb-4">
            </a>
            <p class="font-semibold">&copy; 2024 Global Beauty Rank. All rights reserved.</p>
            <p class="text-sm mt-2">Please take the results with a sense of humor. Beauty is subjective.</p>
            <div class="mt-4 text-sm">
                <a href="terms.html" class="text-gray-500 hover:text-gray-700 hover:underline">Terms of Service</a>
                <span class="mx-2 text-gray-400">·</span>
                <a href="policy.html" class="text-gray-500 hover:text-gray-700 hover:underline">Privacy Policy</a>
            </div>
        </div>
    </footer>

    <script type="module">
        document.addEventListener('DOMContentLoaded', async () => {
            let allRankingsData = null; // Cache for data

            // --- Data Fetching ---
            async function loadStats() {
                try {
                    const response = await fetch('/.netlify/functions/getLandingPageStats');
                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    const data = await response.json();
                    allRankingsData = data.rankings; // Save data to cache
                    
                    populateMarquees(data.marqueeData);
                    populateRankings(data.rankings);
                    startFakeCounter(data.stats.totalCount);
                    
                } catch (error) {
                    console.error("Failed to load stats:", error);
                }
            }

            // --- UI Population Functions ---
            function getCountryCode(countryName) {
                const countryMap = {"Afghanistan":"af","Albania":"al","Algeria":"dz","Andorra":"ad","Angola":"ao","Argentina":"ar","Australia":"au","Austria":"at","Belarus":"by","Belgium":"be","Brazil":"br","Canada":"ca","China":"cn","Denmark":"dk","Egypt":"eg","Finland":"fi","France":"fr","Germany":"de","Greece":"gr","India":"in","Italy":"it","Japan":"jp","Mexico":"mx","Netherlands":"nl","Norway":"no","Poland":"pl","Portugal":"pt","Russia":"ru","Spain":"es","Sweden":"se","Switzerland":"ch","Turkey":"tr","Ukraine":"ua","United Kingdom":"gb","United States":"us"};
                return countryMap[countryName] || 'un';
            }

            function formatTimeAgo(timestamp) {
                if (!timestamp?.seconds) return 'recently';
                const now = new Date();
                const past = new Date(timestamp.seconds * 1000);
                const diffInSeconds = Math.max(0, Math.floor((now - past) / 1000));
                if (diffInSeconds < 5) return 'just now';
                if (diffInSeconds < 60) return `${diffInSeconds}s ago`;
                const diffInMinutes = Math.floor(diffInSeconds / 60);
                if (diffInMinutes < 60) return `${diffInMinutes}m ago`;
                const diffInHours = Math.floor(diffInMinutes / 60);
                if (diffInHours < 24) return `${diffInHours}h ago`;
                const diffInDays = Math.floor(diffInHours / 24);
                return `${diffInDays}d ago`;
            }

            function populateMarquees(data) {
                if (!data || data.length === 0) return;
                let cardHTML = '';
                data.forEach(item => {
                    const flagCode = getCountryCode(item.country);
                    const timeAgo = formatTimeAgo(item.timestamp);
                    const profession = item.profession || 'Profession not specified';
                    cardHTML += `
                    <div class="group clean-card p-4 flex items-center space-x-4 mx-3 flex-shrink-0 relative" style="width: 280px;">
                        <img src="https://flagcdn.com/w80/${flagCode}.png" width="40" height="30" alt="Flag of ${item.country}" class="rounded-md">
                        <div class="flex-grow">
                            <p class="font-bold">${item.name}, ${item.age}</p>
                            <p class="text-sm text-gray-500">${timeAgo}</p>
                        </div>
                        <p class="text-2xl font-extrabold logo-gradient-text">${item.score.toFixed(3)}</p>
                        <div class="absolute inset-0 bg-white bg-opacity-95 backdrop-blur-sm rounded-lg p-4 flex flex-col justify-center items-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                            <p class="font-bold text-lg">${item.country}</p>
                            <p class="text-gray-600">${profession}</p>
                        </div>
                    </div>`;
                });
                document.querySelectorAll('.marquee-content').forEach(container => {
                    container.innerHTML = cardHTML + cardHTML;
                });
            }
            
            // ИЗМЕНЕНО: Функция теперь создает простой список с медалями
            function populateRankings(rankingsData) {
                const container = document.getElementById('main-tabs-content');
                container.innerHTML = '';
                
                const tabMapping = {
                    'countries': rankingsData.countries,
                    'men': rankingsData.men,
                    'women': rankingsData.women,
                    'all': rankingsData.world
                };

                Object.keys(tabMapping).forEach((key) => {
                    const isActive = key === 'countries' ? 'active' : '';
                    let itemsHtml = '';
                    const data = tabMapping[key];

                    if (data && data.length > 0) {
                        data.forEach((item, itemIndex) => {
                            // НОВОЕ: Встроенные SVG для медалей
                            const medals = [
                                `<svg class="w-6 h-6" viewBox="0 0 24 24"><defs><linearGradient id="gold" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:#fdd835;stop-opacity:1" /><stop offset="100%" style="stop-color:#f57f17;stop-opacity:1" /></linearGradient></defs><path fill="url(#gold)" d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/><path fill="#fdd835" d="M12 12.75L14.47 14.5l-.9-2.85L16 9.75h-2.8l-.9-2.85L11.4 9.75H8.6l2.43 1.9-0.9 2.85z"/></svg>`,
                                `<svg class="w-6 h-6" viewBox="0 0 24 24"><defs><linearGradient id="silver" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:#e0e0e0;stop-opacity:1" /><stop offset="100%" style="stop-color:#9e9e9e;stop-opacity:1" /></linearGradient></defs><path fill="url(#silver)" d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/><path fill="#e0e0e0" d="M12 12.75L14.47 14.5l-.9-2.85L16 9.75h-2.8l-.9-2.85L11.4 9.75H8.6l2.43 1.9-0.9 2.85z"/></svg>`,
                                `<svg class="w-6 h-6" viewBox="0 0 24 24"><defs><linearGradient id="bronze" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:#d7ccc8;stop-opacity:1" /><stop offset="100%" style="stop-color:#a1887f;stop-opacity:1" /></linearGradient></defs><path fill="url(#bronze)" d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/><path fill="#d7ccc8" d="M12 12.75L14.47 14.5l-.9-2.85L16 9.75h-2.8l-.9-2.85L11.4 9.75H8.6l2.43 1.9-0.9 2.85z"/></svg>`
                            ];
                            const rankHtml = itemIndex < 3 ? medals[itemIndex] : `<span class="font-bold text-lg text-gray-400 w-6 text-center">${itemIndex + 1}</span>`;
                            const flagCode = getCountryCode(item.country || item.name);
                            const displayName = item.age ? `${item.name}, ${item.age}` : item.name;
                            const bgColor = itemIndex % 2 !== 0 ? 'bg-gray-50/50' : 'bg-transparent';

                            itemsHtml += `
                            <div class="flex items-center justify-between p-3 rounded-lg ${bgColor} ranking-item">
                                <div class="flex items-center space-x-4">
                                    <div class="w-6 text-center flex-shrink-0">${rankHtml}</div>
                                    <img src="https://flagcdn.com/w40/${flagCode}.png" width="30" alt="Flag" class="rounded-sm">
                                    <div><div class="font-semibold">${displayName}</div></div>
                                </div>
                                <div class="font-bold text-lg text-purple-600">${item.score.toFixed(3)}/10</div>
                            </div>`;
                        });
                    } else {
                        itemsHtml = '<p class="text-center text-gray-500 p-4">No data available yet.</p>';
                    }
                    
                    container.innerHTML += `<div id="${key}" class="tab-content ${isActive} space-y-2">${itemsHtml}</div>`;
                });
                document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
            }
            
            // --- Interactivity ---

            function startFakeCounter(initialCount) {
                let participantCount = 5467365 + initialCount;
                const counterElement = document.getElementById('participant-counter');
                setInterval(() => {
                    participantCount += Math.floor(Math.random() * 5) + 1;
                    counterElement.textContent = participantCount.toLocaleString('en-US');
                }, 2500);
            }

            document.getElementById('main-tabs-nav').addEventListener('click', (e) => {
                const button = e.target.closest('.tab-button');
                if (!button) return;
                document.querySelectorAll('#main-tabs-nav .tab-button').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                const targetId = button.dataset.tabTarget;
                const target = document.querySelector(targetId);
                document.querySelectorAll('#main-tabs-content .tab-content').forEach(content => content.classList.remove('active'));
                if (target) target.classList.add('active');
            });
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.15 });

            document.querySelectorAll('.reveal').forEach(el => observer.observe(el));

            const lineProgress = document.getElementById('connecting-line-progress');
            const steps = document.querySelectorAll('[data-step]');
            const stepObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const stepNum = parseInt(entry.target.dataset.step);
                        const progressHeight = (stepNum / steps.length) * 100;
                        if(lineProgress) lineProgress.style.height = `${progressHeight}%`;
                    }
                });
            }, { threshold: 0.8 });

            steps.forEach(step => stepObserver.observe(step));
            
            // --- Initial Load ---
            loadStats();
        });
    </script>
</body>
</html>
